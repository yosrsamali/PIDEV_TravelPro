"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["ui_packages_comment-box_api_file-upload_ts-ui_packages_comment-box_api_preview_ts-ui_packages-630ec3"],{42742:(e,t,r)=>{r.d(t,{fU:()=>p,jw:()=>c,zL:()=>i});var n=r(57572),l=r(96540);let i=[".svg",".gif",".jpg",".jpeg",".png",".mov",".mp4",".webm"],a=[...i,".pdf",".docx",".pptx",".xlsx",".odt",".fodt",".ods",".fods",".odp",".fodp",".odg",".fodg",".odf",".csv",".xls",".zip",".gz",".tgz",".patch",".txt",".log",".md",".json",".jsonc",".cpuprofile",".dmp"];async function o(e,t,r){let l=new FormData,{name:i,size:a,type:o}=e;return t&&l.append("repository_id",t),r&&(l.append("upload_container_type","project"),l.append("upload_container_id",r)),l.append("name",i),l.append("size",a.toString()),l.append("content_type",o),await (0,n.DI)("/upload/policies/assets",{body:l,method:"POST"})}async function s(e,t){let{upload_authenticity_token:r,upload_url:n,header:l,form:i,same_origin:a}=e,o=new FormData;for(let e in a&&o.append("authenticity_token",r),i)o.append(e,i[e]);return o.append("file",t),await fetch(n,{headers:{...l},method:"post",body:o})}async function d(e,t){let r="string"==typeof e.asset_upload_url?e.asset_upload_url:null,n="string"==typeof e.asset_upload_authenticity_token?e.asset_upload_authenticity_token:null;if(r&&n){let e=new FormData;return e.append("authenticity_token",n),await fetch(r,{method:"PUT",body:e,credentials:"same-origin",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}})}return t}async function u(e,t,r){let n=await o(e,t,r);if(!n.ok)throw Error("Upload failed");let l=await n.json(),i=await s(l,e);if(!i.ok)throw Error("Upload failed");let a=await d(l,i);if(!a.ok)throw Error("Upload failed");let{href:u}=await a.json();if("string"!=typeof u)throw Error("Upload failed");return{url:u,file:e}}function c(e){return e?a:i}function p(e,t){return(0,l.useCallback)(async r=>u(r,e,t),[e,t])}},79198:(e,t,r)=>{r.d(t,{y:()=>a});var n=r(57572),l=r(96540);async function i({text:e,issue:t,repository:r,project:l,subjectType:i}){let a=new FormData;a.append("text",e),a.append("issue",t),a.append("repository",r),a.append("project",l),i&&a.append("subject_type",i);let o=await (0,n.DI)("/preview",{body:a,method:"POST"});return o.ok?Promise.resolve(await o.text()):Promise.resolve("Markdown preview unavailable")}function a({subjectId:e,subjectType:t,subjectRepoId:r}){return(0,l.useCallback)(async n=>i({text:n,issue:e?.toString()??"",repository:r?.toString()??"",project:e?.toString()??"",subjectType:function(e){switch(e){case"issue":return"Issue";case"pull_request":return"PullRequest";case"project":return"Project";default:return}}(t)}),[e,t,r])}},76797:(e,t,r)=>{r.d(t,{D:()=>n});function n(e){if("clipboard"in navigator)return navigator.clipboard.writeText(e);let t=document.body;if(!t)return Promise.reject(Error());let r=function(e){let t=document.createElement("pre");return t.style.width="1px",t.style.height="1px",t.style.position="fixed",t.style.top="5px",t.textContent=e,t}(e);return t.appendChild(r),!function(e){if("clipboard"in navigator)return navigator.clipboard.writeText(e.textContent||"");let t=getSelection();if(null==t)return Promise.reject(Error());t.removeAllRanges();let r=document.createRange();r.selectNodeContents(e),t.addRange(r),document.execCommand("copy"),t.removeAllRanges(),Promise.resolve()}(r),t.removeChild(r),Promise.resolve()}},13274:(e,t,r)=>{r.d(t,{n:()=>eq,v:()=>eD});var n=r(74848),l=r(83476),i=r(59356),a=r(84100),o=r(80758),s=r(38621),d=r(58748),u=r(45221),c=r(75177),p=r(65481),f=r(30729),m=r(24021),h=r(96540),g=r(20053);let v=(0,h.createContext)({disabled:!1,condensed:!1,required:!1,formattingToolsRef:{current:null},uploadButtonProps:null,fileDraggedOver:!1,previewMode:!1});try{v.displayName||(v.displayName="MarkdownEditorContext")}catch{}var b=r(55847);let x=({children:e})=>(0,n.jsx)(n.Fragment,{children:e});x.displayName="MarkdownEditor.Actions";let w=(0,h.forwardRef)((e,t)=>{let{disabled:r}=(0,h.useContext)(v);return(0,n.jsx)(b.Q,{ref:t,disabled:r,...e})});w.displayName="MarkdownEditor.ActionButton";let y={flash:"ErrorMessage-module__flash--MopQ2"},k=(0,h.memo)(({message:e})=>(0,n.jsx)(p.A,{variant:"danger",full:!0,className:y.flash,children:e}));k.displayName="MarkdownEditor.ErrorMessage";let C={footer:"Footer-module__footer--ihBso",footerWrapper:"Footer-module__footerWrapper--cGLx2",footerButtonWrapper:"Footer-module__footerButtonWrapper--X7Tti",footerButton:"Footer-module__footerButton--JxULX",childrenStyling:"Footer-module__childrenStyling--ySU6Z"},j=({children:e})=>{let[t,r]=(0,m.H)(e,{footerButtons:_});return(0,n.jsxs)("footer",{className:C.footer,children:[(0,n.jsxs)("div",{className:C.footerWrapper,children:[t.footerButtons&&(0,n.jsx)("div",{className:C.footerButtonWrapper,children:t.footerButtons}),(0,n.jsx)(E,{})]}),(0,n.jsx)("div",{className:C.childrenStyling,children:r})]})},S=({children:e})=>(0,n.jsx)(j,{children:e});S.displayName="MarkdownEditor.Footer";let _=(0,h.forwardRef)((e,t)=>{let{disabled:r}=(0,h.useContext)(v);return(0,n.jsx)(b.Q,{ref:t,size:"small",disabled:r,...e})});_.displayName="MarkdownEditor.FooterButton";let E=(0,h.memo)(()=>{let{uploadButtonProps:e,fileDraggedOver:t}=(0,h.useContext)(v);return e?(0,n.jsx)(N,{fileDraggedOver:t,...e}):null});E.displayName="MarkdownEditor.DefaultFooterButtons";let N=(0,h.memo)(({fileDraggedOver:e,...t})=>{let{condensed:r,disabled:l,fileUploadProgress:i}=(0,h.useContext)(v),a=i?.[0],o=i?.[1],d=!!o,u=1===o?"Uploading your file...":`Uploading your files... (${a}/${o})`;return(0,n.jsx)(b.Q,{variant:"invisible",loadingAnnouncement:d?u:void 0,leadingVisual:s.PaperclipIcon,loading:d,size:"small",className:C.footerButton,onMouseDown:e=>{e.preventDefault()},disabled:l,...t,children:r?"Add files":e?"Drop to add files":"Paste, drop, or click to add files"})});N.displayName="MarkdownEditor.FileUploadButton";try{j.displayName||(j.displayName="CoreFooter")}catch{}let L=(0,h.forwardRef)(({forInputId:e},t)=>{(0,h.useEffect)(()=>{r.e("vendors-node_modules_github_markdown-toolbar-element_dist_index_js").then(r.bind(r,78143))},[]);let l=(0,h.useRef)(null),i=(0,h.useRef)(null),a=(0,h.useRef)(null),o=(0,h.useRef)(null),s=(0,h.useRef)(null),d=(0,h.useRef)(null),u=(0,h.useRef)(null),c=(0,h.useRef)(null),p=(0,h.useRef)(null),f=(0,h.useRef)(null),m=(0,h.useRef)(null);return(0,h.useImperativeHandle)(t,()=>({header:()=>l.current?.click(),bold:()=>i.current?.click(),italic:()=>a.current?.click(),quote:()=>o.current?.click(),code:()=>s.current?.click(),link:()=>d.current?.click(),unorderedList:()=>u.current?.click(),orderedList:()=>c.current?.click(),taskList:()=>p.current?.click(),mention:()=>f.current?.click(),reference:()=>m.current?.click()})),(0,n.jsxs)("markdown-toolbar",{for:e,style:{display:"none"},children:[(0,n.jsx)("md-header",{ref:l}),(0,n.jsx)("md-bold",{ref:i}),(0,n.jsx)("md-italic",{ref:a}),(0,n.jsx)("md-quote",{ref:o}),(0,n.jsx)("md-code",{ref:s}),(0,n.jsx)("md-link",{ref:d}),(0,n.jsx)("md-unordered-list",{ref:u}),(0,n.jsx)("md-ordered-list",{ref:c}),(0,n.jsx)("md-task-list",{ref:p}),(0,n.jsx)("md-mention",{ref:f}),(0,n.jsx)("md-ref",{ref:m})]})});L.displayName="MarkdownEditor.FormattingTools";var I=r(52464);let T=({children:e,disabled:t,required:r,visuallyHidden:l,sx:i,as:a="label",className:o,...s})=>(0,n.jsx)(I.A,{as:a,sx:{fontWeight:"bold",fontSize:1,display:"block",color:t?"fg.muted":"fg.default",cursor:t?"not-allowed":"pointer",alignSelf:"flex-start",...i},className:l?(0,g.$)("sr-only",o):o,...s,children:r?(0,n.jsxs)(c.A,{as:"span",sx:{display:"flex"},children:[(0,n.jsx)(c.A,{sx:{mr:1},children:e}),(0,n.jsx)("span",{children:"*"})]}):e});try{T.displayName||(T.displayName="InputLabel")}catch{}let M={inputLabel:"Label-module__inputLabel--NkHiQ"},$=({...e})=>{let{disabled:t,required:r}=(0,h.useContext)(v);return(0,n.jsx)(T,{as:"legend",disabled:t,required:r,className:M.inputLabel,...e})};$.displayName="MarkdownEditor.Label";let A=e=>(0,n.jsx)($,{...e});r(90204);var D=r(62456),R=r(8338),H=r(92575),P=r(5804);let B={identifierText:"use-mention-suggestions-module__identifierText--vdUed"},W={triggerChar:"@"},O=e=>({value:e.identifier,render:t=>(0,n.jsxs)(R.l.Item,{...t,children:[e.avatarUrl&&(0,n.jsx)(R.l.LeadingVisual,{children:(0,n.jsx)(D.r,{size:16,src:e.avatarUrl})}),(0,n.jsx)("span",{className:B.identifierText,children:e.identifier})," ",(0,n.jsx)(R.l.Description,{truncate:!0,children:e.description})]})}),F=(e,t)=>{let r=Math.max((0,P.dt)(e,t.identifier),(0,P.dt)(e,t.description));return r===P.IP?r:r>0&&t.participant?P.M4:t.participant?r+P.Dx:r},z=(e,t)=>e.participant&&!t.participant?-1:t.participant&&!e.participant?1:e.identifier.localeCompare(t.identifier),V=e=>({calculateSuggestions:(0,h.useMemo)(()=>(0,H.C)(e,F,z,O),[e]),trigger:W});var U=r(44968);let K={suggestionTitle:"use-reference-suggestions-module__suggestionTitle--N45Y8"},q={triggerChar:"#",multiWord:!0},Q=e=>({value:e.id,render:t=>(0,n.jsxs)(R.l.Item,{...t,children:[e.iconHtml&&(0,n.jsx)(R.l.LeadingVisual,{children:(0,n.jsx)(U.yx,{unverifiedHTML:e.iconHtml})}),(0,n.jsx)("span",{className:K.suggestionTitle,children:(0,n.jsx)(U.yx,{unverifiedHTML:e.titleHtml})})," ",(0,n.jsxs)(R.l.Description,{truncate:!0,children:["#",e.id]})]})}),G=(e,t)=>(0,P.dt)(e,`${t.id} ${t.titleText}`),X=(e,t)=>0,J=e=>({calculateSuggestions:(0,h.useMemo)(()=>{let t=(0,H.C)(e,G,X,Q);return async e=>/^\d+\s/.test(e)?[]:t(e)},[e]),trigger:q});var Y=r(70255),Z=r(83876),ee=r(64515),et=r(51856),er=r(44358),en=r(12800);let el=e=>{let[t,r]=(0,h.useState)(null),[n,l]=(0,h.useState)(null),i=(0,h.useMemo)(()=>e.map(({trigger:e})=>e),[e]),a=(0,h.useRef)(null);return(0,h.useEffect)(()=>{if(!n){r(null);return}(async function(){for(let{trigger:t,suggestionsCalculator:l}of(a.current=n,r("loading"),e))if(n.trigger.triggerChar===t.triggerChar){r(await l(n.query));break}})()},[n,e]),{triggers:i,suggestions:t,setSuggestionEvent:l,onHideSuggestions:()=>{l(null),r(null)},active:!!n}},ei={textArea:"MarkdownInput-module__textArea--QjIwG",fullHeight:"MarkdownInput-module__fullHeight--GQ5pQ",monospace:"MarkdownInput-module__monospace--hhBf3",displayNone:"MarkdownInput-module__displayNone--PnY5h",isDraggedOver:"MarkdownInput-module__isDraggedOver--Ual6r"},ea=[],eo=(0,h.forwardRef)(({value:e,onChange:t,onInput:r,disabled:l,placeholder:i,id:a,maxLength:o,onKeyDown:s,fullHeight:d,isDraggedOver:u,emojiSuggestions:c,emojiTone:p,mentionSuggestions:f,referenceSuggestions:m,labelledBy:v,minHeightLines:b,maxHeightLines:x,visible:w,monospace:y,pasteUrlsAsPlainText:k,className:C,...j},S)=>{let _=(0,h.useMemo)(()=>({tone:p}),[p]),{trigger:E,calculateSuggestions:N}=(0,Z.x)(c??ea,_),{trigger:L,calculateSuggestions:I}=V(f??ea),{trigger:T,calculateSuggestions:M}=J(m??ea),{triggers:$,suggestions:A,setSuggestionEvent:D,onHideSuggestions:R}=el((0,h.useMemo)(()=>[{trigger:E,suggestionsCalculator:N},{trigger:L,suggestionsCalculator:I},{trigger:T,suggestionsCalculator:M}],[N,I,M,E,L,T])),H=(0,h.useRef)(null);(0,ee.T)(S,H),(0,h.useEffect)(()=>{let e=H.current&&(0,er.B1)(H.current,{defaultPlainTextPaste:{urlLinks:k}});return e?.unsubscribe},[k]);let P=(0,en.S)({disabled:d||!w,maxHeightLines:x,minHeightLines:b,elementRef:H,value:e});return(0,h.useEffect)(()=>{H.current&&(H.current.value=e)}),(0,n.jsx)(Y.a,{triggers:$,suggestions:A,onShowSuggestions:D,onHideSuggestions:R,firstOptionSelectionMode:"selected",style:{flex:"auto"},tabInsertsSuggestions:!0,children:(0,n.jsx)(et.Ay,{id:a,ref:H,placeholder:i,maxLength:o,onKeyDown:s,disabled:l,"aria-label":v?void 0:"Markdown value","aria-labelledby":v,onChange:t,onInput:r,value:e,className:(0,g.$)(C,ei.textArea,!w&&ei.displayNone,d&&ei.fullHeight,y&&ei.monospace,u&&ei.isDraggedOver),rows:b,style:P,...j})})});eo.displayName="MarkdownInput";var es=r(19920),ed=r(10871),eu=r(87330);let ec={iconButton:"ToolbarButton-module__iconButton--fTMrr"},ep=(0,h.forwardRef)((e,t)=>{let{disabled:r,condensed:l}=(0,h.useContext)(v);return(0,n.jsx)(eu.K,{ref:t,size:l?"small":"medium",variant:"invisible",disabled:r,onMouseDown:e=>e.preventDefault(),...e,className:ec.iconButton})});ep.displayName="MarkdownEditor.ToolbarButton";var ef=r(47584);let em=(0,h.createContext)(null),eh=()=>{let e=(0,h.useContext)(em);(0,h.useImperativeHandle)(e?.ref,()=>({openMenu:()=>{r(!0)}}));let[t,r]=(0,h.useState)(!1);(0,h.useEffect)(()=>{i(""),t&&e?.onOpen()},[e,t]);let[l,i]=(0,h.useState)(""),a=e?.savedReplies.filter(({name:e})=>e.toLowerCase().includes(l.toLowerCase())).map((e,t)=>({text:e.name,description:e.content,descriptionVariant:"block",trailingVisual:t<9?`Ctrl + ${t+1}`:void 0,sx:{"& [class*=BaseVisualContainer]:first-child":{display:"none"},"& [class*=DescriptionContainer]":{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"}}})),o=t=>{r(!1);let n=e?.savedReplies.find(({name:e})=>e===t?.text);n&&e?.onSelect(n)};return a?(0,n.jsx)(es.X,{renderAnchor:e=>(0,n.jsx)(ep,{...e,icon:s.ReplyIcon,"aria-label":"Saved replies","aria-labelledby":void 0}),open:t,onOpenChange:r,items:a,filterValue:l,onFilterChange:i,placeholderText:"Search saved replies",selected:void 0,onSelectedChange:e=>{o(Array.isArray(e)?e[0]:e)},overlayProps:{width:"small",maxHeight:"small",anchorSide:"outside-right",onKeyDown:e=>{let t=parseInt(e.key,10);a&&e.ctrlKey&&!Number.isNaN(t)&&t>=1&&t<=9&&(e.stopPropagation(),e.preventDefault(),o(a[t-1]))}},footer:(0,n.jsx)(ed.z,{size:"small",href:`${ef.fV.origin}/settings/replies`,block:!0,children:"Create new"})}):(0,n.jsx)(n.Fragment,{})};try{em.displayName||(em.displayName="SavedRepliesContext")}catch{}try{eh.displayName||(eh.displayName="SavedRepliesButton")}catch{}var eg=r(69676),ev=r(82678);let eb={divider:"Toolbar-module__divider--uW6mE",toolbar:"Toolbar-module__toolbar--CkIKP"},ex=()=>(0,n.jsx)("div",{className:eb.divider}),ew=(0,h.memo)(()=>{let{condensed:e,formattingToolsRef:t}=(0,h.useContext)(v);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(ep,{onClick:()=>t.current?.header(),icon:s.HeadingIcon,"aria-label":"Heading"}),(0,n.jsx)(ep,{onClick:()=>t.current?.bold(),icon:s.BoldIcon,"aria-label":"Bold"}),(0,n.jsx)(ep,{onClick:()=>t.current?.italic(),icon:s.ItalicIcon,"aria-label":"Italic"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(ex,{}),(0,n.jsx)(ep,{onClick:()=>t.current?.quote(),icon:s.QuoteIcon,"aria-label":"Quote"}),(0,n.jsx)(ep,{onClick:()=>t.current?.code(),icon:s.CodeIcon,"aria-label":"Code"}),(0,n.jsx)(ep,{onClick:()=>t.current?.link(),icon:s.LinkIcon,"aria-label":"Link"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(ex,{}),(0,n.jsx)(ep,{onClick:()=>t.current?.unorderedList(),icon:s.ListUnorderedIcon,"aria-label":"Unordered list"}),(0,n.jsx)(ep,{onClick:()=>t.current?.orderedList(),icon:s.ListOrderedIcon,"aria-label":"Numbered list"}),(0,n.jsx)(ep,{onClick:()=>t.current?.taskList(),icon:s.TasklistIcon,"aria-label":"Task list"})]}),!e&&(0,n.jsxs)("div",{children:[(0,n.jsx)(ex,{}),(0,n.jsx)(ep,{onClick:()=>t.current?.mention(),icon:s.MentionIcon,"aria-label":"Mention"}),(0,n.jsx)(ep,{onClick:()=>t.current?.reference(),icon:s.CrossReferenceIcon,"aria-label":"Reference"})]}),(0,n.jsx)(eh,{})]})});ew.displayName="MarkdownEditor.DefaultToolbarButtons";let ey=({children:e})=>{let t=(0,h.useRef)(null);return(0,ev.G)({containerRef:t,focusInStrategy:"closest",bindKeys:eg.z0.ArrowHorizontal|eg.z0.HomeAndEnd,focusOutBehavior:"wrap"}),(0,n.jsx)("div",{ref:t,"aria-label":"Formatting tools",role:"toolbar",className:eb.toolbar,children:e})},ek=({children:e})=>(0,n.jsx)(ey,{children:e});ek.displayName="MarkdownEditor.Toolbar";try{ex.displayName||(ex.displayName="Divider")}catch{}try{ey.displayName||(ey.displayName="CoreToolbar")}catch{}var eC=r(60499);let ej={viewSwitch:"ViewSwitch-module__viewSwitch--fmIde",tabNavLink:"ViewSwitch-module__tabNavLink--AZkCL",editColor:"ViewSwitch-module__editColor--UxQhv",previewColor:"ViewSwitch-module__previewColor--aXo83"},eS=({selectedView:e,onViewSelect:t,onLoadPreview:r,disabled:l})=>{let i="preview"===e?{onClick:()=>t?.("edit")}:{onClick:()=>{r(),t?.("preview")},onMouseOver:()=>r(),onFocus:()=>r()};return(0,n.jsx)("div",{className:ej.viewSwitch,children:(0,n.jsxs)(eC.A,{"aria-label":"View mode",children:[(0,n.jsx)(eC.A.Link,{...i,as:"button",selected:"edit"===e,disabled:l,className:(0,g.$)(ej.tabNavLink,"edit"===e?ej.editColor:ej.previewColor),children:"Write"}),(0,n.jsx)(eC.A.Link,{...i,as:"button",selected:"preview"===e,disabled:l,className:(0,g.$)(ej.tabNavLink,"preview"===e?ej.editColor:ej.previewColor),children:"Preview"})]})})};try{eS.displayName||(eS.displayName="ViewSwitch")}catch{}let e_=/^([^/]+)\/([^;]+)/,eE=e=>{if(e.startsWith("."))return t=>t.name.toLowerCase().endsWith(e.toLowerCase());{let t=e_.exec(e);if(null===t)return()=>!1;let[,r,n]=t;return e=>{let[,t,l]=e_.exec(e.type)??[];return r?.toLowerCase()===t?.toLowerCase()&&("*"===n||n?.toLowerCase()===l?.toLowerCase())}}};function eN(e){let t=(0,h.useMemo)(()=>e.acceptedFileTypes?.map(eE),[e.acceptedFileTypes]),r=(0,h.useCallback)(e=>t?.some(t=>t(e))??!0,[t]);return(0,h.useCallback)(function(t){if(0===t.length)return!1;if(e.multi){let n=[],l=[];for(let e of t)r(e)?n.push(e):l.push(e);e.onSelect(n,l)}else{let n=t[0];n&&r(n)?e.onSelect(n,void 0):e.onSelect(void 0,n)}return!0},[r,e.multi,e.onSelect])}let eL=e=>Array.from(e.dataTransfer.items).some(({kind:e})=>"file"===e);var eI=r(32020),eT=r(42445);let eM=e=>(0,eI.nf)(`Uploading "${e.name}"...`),e$=(e,t,r)=>t?e.type.startsWith("video/")?t:e.type.startsWith("image/")?(0,eI.TG)(r||{width:0,height:0,ppi:1},t,"Image"):(0,eI.iQ)(e.name,t):(0,eI.nf)(`Failed to upload "${e.name}"`),eA=()=>{},eD=({emitChange:e,value:t,inputRef:r,disabled:n,onUploadFile:l,acceptedFileTypes:i})=>{let[o,s]=(0,h.useState)(void 0),d=(0,h.useRef)(!1);(0,h.useEffect)(()=>{if(o){d.current=!1;let e=setTimeout(()=>d.current=!0,1e3);return()=>clearTimeout(e)}},[o]),(0,h.useEffect)(()=>{d.current&&s(void 0)},[t]);let u=(0,a.U)(e=>{let t=new Set(e.map(({name:e})=>{let t=e.split(".");return t.length>1?`.${t.at(-1)}`:""}).filter(e=>""!==e));t.size>0&&s(`File type${t.size>1?"s":""} not allowed: ${[...t].join(", ")}`)}),[c,p]=(0,h.useState)(void 0),f=(0,a.U)(()=>p(void 0)),m=(0,h.useCallback)(t=>{if(!r?.current)return;let n=function(e,t){if(0===t||"\n"===e[t-1]&&(1===t||"\n"===e[t-2]))return"";let r=e.lastIndexOf("\n",t-1);return/\S/.test(e.substring(r,t))?"\n\n":"\n"}(r.current.value,r.current.selectionStart),l=function(e,t){if(e.length===t||"\n"===e[t]&&(t===e.length-1||"\n"===e[t+1]))return"";let r=e.indexOf("\n",t);return/\S/.test(e.substring(t,r))?"\n\n":"\n"}(r.current.value,r.current.selectionEnd);e(`${n}${t.map(eM).join("\n")}${l}`)},[r,e]),g=(t,n,l)=>{if(!r?.current)return;let i=eM(t),a=r.current.value.indexOf(i);-1!==a&&e(e$(t,n,l),[a,a+i.length])},v=(0,a.U)(({file:e,url:t},r)=>{p(e=>e&&[e[0]+1,e[1]]),g(e,t,r)}),b=(0,h.useCallback)(e=>e.map(async e=>{let t={url:null,file:e},r=null;try{t=await l?.(e)??{file:e,url:null}}catch{t={file:e,url:null}}if(t.url)try{r=await (0,eI.pF)(e)}catch{r={width:0,height:0,ppi:1},(0,eT.N7)("Failed to get image size from file",{message:"Failed to get image size from file",reactAppName:"markdown-editor"})}v(t,r)}),[l,v]),x=function(e){let t=function(e){let t=eN(e),{multi:r,acceptedFileTypes:n}=e,l=(0,h.useRef)(null),i=(0,h.useCallback)(function(){this.files&&t(this.files)},[t]);(0,h.useEffect)(function(){let e=document.createElement("input");return e.setAttribute("type","file"),e.setAttribute("multiple",r?"true":"false"),n&&e.setAttribute("accept",n.join(", ")),e.style.display="none",e.addEventListener("change",i),document.body.appendChild(e),l.current=e,()=>{l.current=null,e.removeEventListener("change",i),e.parentNode?.removeChild(e)}},[r,n,i]);let a=(0,h.useCallback)(()=>l.current?.click(),[]);return(0,h.useMemo)(()=>({onClick:a}),[a])}(e),r=function(e){let t=eN(e);return(0,h.useMemo)(()=>({onPaste:e=>{t(e.clipboardData.files)&&e.preventDefault()}}),[t])}(e),[n,l]=function(e){let t=eN(e),[r,n]=(0,h.useState)(!1),l=(0,h.useCallback)(()=>n(!1),[]),i=(0,h.useCallback)(e=>{eL(e)&&(n(!0),e.stopPropagation(),e.preventDefault())},[]),a=(0,h.useCallback)(e=>{eL(e)&&(e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy")},[]),o=(0,h.useCallback)(e=>{t(e.dataTransfer.files)&&(e.preventDefault(),n(!1))},[t]);return[r,(0,h.useMemo)(()=>({onDragEnter:i,onDragOver:a,onDragLeave:l,onDrop:o}),[o,a,l,i])]}(e);return(0,h.useMemo)(()=>({clickTargetProps:t,pasteTargetProps:r,dropTargetProps:l,isDraggedOver:n}),[t,l,n,r])}({acceptedFileTypes:i,multi:!0,onSelect:(0,h.useCallback)(async(e,t)=>{e.length>0&&(p([1,e.length]),m(e),await Promise.all(b(e)),f()),u(t)},[u,m,b,f])});return n&&(x={clickTargetProps:{onClick:eA},dropTargetProps:{onDragEnter:eA,onDragLeave:eA,onDrop:eA,onDragOver:eA},pasteTargetProps:{onPaste:eA},isDraggedOver:!1}),l?{...x,errorMessage:o,uploadProgress:c}:null},eR=/^(?:\t| ? ?)(.*)/,eH=e=>eR.exec(e)?.[1]??"",eP=e=>`  ${e}`,eB=({emitChange:e})=>({onKeyDown:(0,h.useCallback)(t=>{let r=t.currentTarget;if(t.defaultPrevented||"Tab"!==t.key||r.selectionEnd-r.selectionStart==0)return;t.preventDefault();let[n,l]=(0,eI.ty)(r),i=r.value.slice(n,l).split(/\r?\n/).map(e=>t.shiftKey?eH(e):eP(e)).join("\n");e(i,[n,l],[n,n+i.length])},[e])});var eW=r(27278),eO=r(75632),eF=r(73218);let ez={container:"MarkdownEditor-module__container--LVNU1",inputWrapper:"MarkdownEditor-module__inputWrapper--MtV0d",fieldSet:"MarkdownEditor-module__fieldSet--VAeuT",previewHeader:"MarkdownEditor-module__previewHeader--kOTcb",fullHeight:"MarkdownEditor-module__fullHeight--loH82",hidden:"MarkdownEditor-module__hidden--_X5vc",disabled:"MarkdownEditor-module__disabled--idNQD",previewWrapper:"MarkdownEditor-module__previewWrapper--UHhTL",header:"MarkdownEditor-module__header--i0pok",viewSwitchWrapper:"MarkdownEditor-module__viewSwitchWrapper--ezg8E",viewSwitchBorder:"MarkdownEditor-module__viewSwitchBorder--zeiDB",previewViewerWrapper:"MarkdownEditor-module__previewViewerWrapper--ZCTeH",flash:"MarkdownEditor-module__flash--bC3Co"},eV=Symbol(),eU=[],eK=(0,h.forwardRef)(({value:e,onChange:t,onInputFocus:r,disabled:b=!1,placeholder:w,maxLength:y,"aria-describedby":C,labelledBy:_,fullHeight:E,onRenderPreview:N,sx:I,onPrimaryAction:T,viewMode:M,onChangeViewMode:$,minHeightLines:D=5,maxHeightLines:R=35,emojiSuggestions:H,emojiTone:P,mentionSuggestions:B,referenceSuggestions:W,onUploadFile:O,acceptedFileTypes:F,monospace:z=!1,required:V=!1,name:U,children:K,savedReplies:q,pasteUrlsAsPlainText:Q=!1,errorMessage:G,teamHovercardsEnabled:X=!1,onSavedRepliesOpen:J=eF.l},Y)=>{let[Z,ee]=(0,m.H)(K,{toolbar:ek,actions:x,label:A,footer:S}),[et,er]=(0,h.useState)("edit"),[en,el]=void 0===M?[et,er]:[M,$],[ei,ea]=(0,h.useState)(null),es=(0,a.U)(ea),ed=(0,h.useRef)(!0);(0,h.useEffect)(()=>{ed.current=!0},[e]);let eu=async()=>{ed.current&&(ed.current=!1,es(null),es(await N(e)))},ec=(0,eO.G7)("mardown_editor_use_on_input");(0,h.useEffect)(()=>{"preview"===en&&ed.current&&eu()});let[ep,ef]=(0,h.useState)(1),eh=()=>{t(""),ef(e=>e+1)},eg=(0,h.useRef)(null);(0,h.useImperativeHandle)(Y,()=>({focus:e=>eg.current?.focus(e),scrollIntoView:e=>eL.current?.scrollIntoView(e),reset:()=>eh(),[eV]:void 0}));let ev=(0,h.useRef)(0);eg.current&&eg.current.offsetHeight&&(ev.current=eg.current.offsetHeight);let eb=(0,h.useCallback)(e=>{t(e.target.value)},[t]),ex=(0,o.H)({inputRef:eg,fallbackEventHandler:eb}),eC=eD({emitChange:ex,value:e,inputRef:eg,disabled:b,onUploadFile:O,acceptedFileTypes:F}),ej=eC?.uploadProgress!==void 0,e_=(0,eW.KI)({emitChange:ex}),eE=eB({emitChange:ex}),eN=(0,h.useRef)(null),eL=(0,h.useRef)(null),[eT,eM]=(0,h.useState)(!1),e$=(0,h.useCallback)(()=>eM(null!==eL.current&&eL.current.clientWidth<675),[]);(0,d.w)(e$,eL),(0,u.A)(()=>{let e=eL.current;if(!e)return;let t=e.parentElement,r=eL.current.nextSibling;t?.removeChild(e),t?.insertBefore(e,r)},[eT]);let eA=(0,h.useId)(),eR=`${eA}-description`,eH=(0,h.useRef)(null),eP=(0,h.useMemo)(()=>q?{savedReplies:q,onSelect:e=>{requestAnimationFrame(()=>ex(e.content))},onOpen:J,ref:eH}:null,[ex,J,q]),eK=(0,i._)(e=>{let t=eN.current;if(!b){if(e.ctrlKey&&"."===e.key)eH.current?.openMenu(),e.preventDefault(),e.stopPropagation();else if((0,eI.VL)(e)){if("Enter"!==e.key||ej){if("b"===e.key)t?.bold();else if("i"===e.key)t?.italic();else if(e.shiftKey&&"."===e.key)t?.quote();else if("e"===e.key)t?.code();else if("k"===e.key)t?.link();else if("8"===e.key)t?.unorderedList();else if(e.shiftKey&&"7"===e.key)t?.orderedList();else if(e.shiftKey&&["l","L"].includes(e.key))t?.taskList();else{if(!(e.shiftKey&&["p","P"].includes(e.key)))return;el?.("preview")}}else T?.();e.preventDefault(),e.stopPropagation()}else e_.onKeyDown(e),eE.onKeyDown(e)}});(0,h.useEffect)(()=>{if("preview"===en){eU.push(eA);let e=e=>{!e.defaultPrevented&&eU.at(-1)===eA&&(0,eI.VL)(e)&&e.shiftKey&&"p"===e.key&&(el?.("edit"),setTimeout(()=>eg.current?.focus()),e.preventDefault())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e),eU=eU.filter(e=>e!==eA)}}},[en,el,eA]);let eq=(0,h.useMemo)(()=>({disabled:b,formattingToolsRef:eN,condensed:eT,required:V,fileDraggedOver:eC?.isDraggedOver??!1,fileUploadProgress:eC?.uploadProgress,uploadButtonProps:eC?.clickTargetProps??null,errorMessage:eC?.errorMessage,previewMode:"preview"===en}),[b,eT,V,eC?.isDraggedOver,eC?.uploadProgress,eC?.clickTargetProps,eC?.errorMessage,en]);return(0,n.jsx)(v.Provider,{value:eq,children:(0,n.jsxs)("fieldset",{"aria-disabled":b,className:(0,g.$)(ez.fieldSet,E&&ez.fullHeight),children:[(0,n.jsx)(L,{ref:eN,forInputId:eA}),(0,n.jsx)("div",{className:ez.hidden,children:ee}),Z.label,(0,n.jsxs)("div",{ref:eL,className:ez.container,children:[(0,n.jsxs)(c.A,{className:(0,g.$)("edit"===en?ez.inputWrapper:ez.previewWrapper,b&&ez.disabled,E&&ez.fullHeight),sx:I,children:[(0,n.jsxs)("span",{className:"sr-only",id:eR,"aria-live":"polite",children:["Markdown input:","preview"===en?" preview mode selected.":" edit mode selected."]}),(0,n.jsxs)("header",{className:ez.header,children:[(0,n.jsxs)("div",{className:ez.viewSwitchWrapper,children:[(0,n.jsx)(eS,{selectedView:en,onViewSelect:el,disabled:eC?.uploadProgress!==void 0,onLoadPreview:eu}),(0,n.jsx)("div",{className:ez.viewSwitchBorder})]}),(0,n.jsx)(em.Provider,{value:eP,children:"edit"===en&&(Z.toolbar??(0,n.jsx)(ey,{children:(0,n.jsx)(ew,{})}))})]}),(0,n.jsx)(eo,{value:e,onChange:ec?void 0:eb,onInput:ec?eb:void 0,onFocus:r,emojiSuggestions:H,emojiTone:P,mentionSuggestions:B,referenceSuggestions:W,disabled:b,placeholder:w,labelledBy:_,"aria-describedby":C?`${eR} ${C}`:eR,id:eA,maxLength:y,ref:eg,fullHeight:E,isDraggedOver:eC?.isDraggedOver??!1,minHeightLines:D,maxHeightLines:R,visible:"edit"===en,monospace:z,required:V,name:U,pasteUrlsAsPlainText:Q,...eK,...eC?.pasteTargetProps,...eC?.dropTargetProps},ep),(0,n.jsx)("div",{role:"alert",children:"edit"===en&&eC?.errorMessage&&(0,n.jsx)(k,{message:eC.errorMessage})}),"preview"===en&&(0,n.jsxs)("div",{"aria-live":"polite",tabIndex:-1,className:(0,g.$)(ez.previewViewerWrapper,E&&ez.fullHeight),style:{minHeight:ev.current},children:[(0,n.jsx)("h2",{className:ez.previewHeader,children:"Rendered Markdown Preview"}),(0,n.jsx)(l.G,{verifiedHTML:ei||"Nothing to preview",loading:null===ei,teamHovercardsEnabled:X,openLinksInNewTab:!0})]})]}),G&&(0,n.jsxs)(p.A,{variant:"danger",className:ez.flash,children:[(0,n.jsx)(f.A,{icon:s.StopIcon,className:"mr-2"}),G]}),Z.footer??(0,n.jsx)(j,{children:(0,h.isValidElement)(Z.actions)&&Z.actions.props.children})]})]})})});eK.displayName="MarkdownEditor";let eq=Object.assign(eK,{Label:A,Toolbar:ek,ToolbarButton:ep,DefaultToolbarButtons:ew,Footer:S,FooterButton:_,Actions:x,ActionButton:w,MarkdownEditorContext:v})},92575:(e,t,r)=>{r.d(t,{C:()=>l});var n=r(5804);let l=(e,t,r,l,i)=>async a=>{if("loading"===e)return"loading";let o=Array.isArray(e)?e:await e(),s=a?o.map(e=>[t(a,e),e]).filter(([e])=>e>n.IP).sort(([e,t],[n,l])=>n===e?-r(l,t):n-e).slice(0,5).map(([,e])=>e):o.slice(0,5);return i&&s.sort(r),s.map(l)}},27278:(e,t,r)=>{r.d(t,{KI:()=>c,VB:()=>d,a1:()=>u});var n=r(96540),l=r(32020);let i=({leadingWhitespace:e="",delimeter:t,taskBox:r,text:n})=>{if(!n)return null;let l="number"==typeof t?`${t+1}.`:t;return`
${e}${l}${r?" [ ]":""} `},a=({leadingWhitespace:e="",delimeter:t,taskBox:r})=>{let n="number"==typeof t?`${t}.`:t;return`${n}${e}${r?" [ ]":" "}
`},o=/^(\s*(?:>\s*)*(?:[*-]\s{1,4})*)([*-]|(\d+)\.)(\s{1,4})(?:(\[[\sx]\])\s)?(.*)/i,s=e=>"number"==typeof e?.delimeter,d=e=>{let t=o.exec(e);if(!t)return null;let[,r="",n,l="",i,a=null,s]=t,d=Number.parseInt(l,10);return{leadingWhitespace:r,text:s,delimeter:Number.isNaN(d)?n:d,middleWhitespace:i,taskBox:a}},u=e=>"number"==typeof e.delimeter?`${e.leadingWhitespace}${e.delimeter}.${e.middleWhitespace}${e.taskBox?`${e.taskBox} `:""}${e.text}`:`${e.leadingWhitespace}${e.delimeter}${e.middleWhitespace}${e.taskBox||""} ${e.text}`,c=({emitChange:e})=>{let t=(0,n.useCallback)((t,r)=>{let[n,i]=r||(0,l.ty)(t),a=d(t.value.slice(n,i));if(!s(a))return;let o=t.value.slice(i+1).split(/\r?\n/),c=[],p=a.delimeter;for(let e of o){let t=d(e);if(!s(t)||t.delimeter!==p)break;c.push(t),p++}if(0===c.length)return;let f=`
${c.map(e=>u({...e,delimeter:e.delimeter+1})).join("\n")}`;e(f,[i,i+f.length+1],t.selectionStart)},[e]);return{onKeyDown:(0,n.useCallback)(r=>{if("Enter"===r.key&&!r.shiftKey&&!r.defaultPrevented){let n=r.currentTarget,[o,s]=(0,l.ty)(n),u=d(n.value.slice(o,n.selectionStart)+n.value.slice(n.selectionEnd,s));if(u){if(r.preventDefault(),n.selectionStart===o){let r=a(u);null===r?e("",[o,n.selectionEnd]):(e(r),t(n,[o,o+r.length-1]))}else{let r=i(u);null===r?e("",[o,n.selectionEnd]):(e(r),t(n))}}}},[e,t])}}},32020:(e,t,r)=>{r.d(t,{pF:()=>u,ty:()=>i,VL:()=>s,nf:()=>a,TG:()=>c,iQ:()=>o});var n=r(96884);function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let PNGScanner=class PNGScanner{advance(e){this.pos+=e}readInt(e){let t=this,r=function(){switch(e){case 1:return t.dataview.getUint8(t.pos);case 2:return t.dataview.getUint16(t.pos);case 4:return t.dataview.getUint32(t.pos);default:throw Error("bytes parameter must be 1, 2 or 4")}}();return this.advance(e),r}readChar(){return this.readInt(1)}readShort(){return this.readInt(2)}readLong(){return this.readInt(4)}readString(e){let t=[];for(let r=0;r<e;r++)t.push(String.fromCharCode(this.readChar()));return t.join("")}scan(e){if(0x89504e47!==this.readLong())throw Error("invalid PNG");for(this.advance(4);;){let t=this.readLong(),r=this.readString(4),n=this.pos+t+4;if(!1===e.call(this,r,t)||"IEND"===r)break;this.pos=n}}constructor(e,t){l(this,"dataview",void 0),l(this,"pos",void 0),l(this,"callback",void 0),this.dataview=new DataView(e),this.pos=0,this.callback=t}};let i=e=>{let t=e.value.lastIndexOf("\n",e.selectionStart-1)+1,r=e.value.indexOf("\n",e.selectionEnd);return -1===r&&(r=e.value.length),[t,r]},a=e=>`<!-- ${e.replaceAll("--","\\-\\-")} -->`,o=(e,t)=>`[${e.replaceAll("[","\\[").replaceAll("]","\\]")}](${t.replaceAll("(","\\(").replaceAll(")","\\)")})`,s=e=>(0,n.U0)()?e.metaKey:e.ctrlKey,d=e=>{let t=new PNGScanner(e),r={width:0,height:0,ppi:1};return t.scan(function(e){switch(e){case"IHDR":r.width=this.readLong(),r.height=this.readLong();break;case"pHYs":{let e;let t=this.readLong(),n=this.readLong();return 1===this.readChar()&&(e=.0254),e&&(r.ppi=Math.round((t+n)/2*e)),!1}case"IDAT":return!1}return!0}),r},u=async e=>{let t=await new Promise((t,r)=>{let n=new FileReader;n.onload=()=>t(n.result),n.onerror=()=>r(n.error),n.readAsArrayBuffer(e)});return t?d(t):null},c=(e,t,r="Image")=>{if(144===e.ppi){let n=Math.round(e.width/2);return`<img width="${n}" alt="${r}" src="${t}" />`}return`![${r}](${t})`}},12800:(e,t,r)=>{r.d(t,{S:()=>i});var n=r(38568),l=r(96540);let i=({disabled:e,minHeightLines:t,maxHeightLines:r,elementRef:i,value:a})=>{let[o,s]=(0,l.useState)(void 0),[d,u]=(0,l.useState)(void 0),[c,p]=(0,l.useState)(void 0),f=(0,l.useCallback)(()=>{if(e)return;let n=i.current;if(!n)return;let l=getComputedStyle(n);s(`calc(${n.scrollHeight}px - ${l.paddingTop} - ${l.paddingBottom})`);let a="normal"===l.lineHeight?`1.2 * ${l.fontSize}`:l.lineHeight;void 0!==t&&u(`calc(${t} * ${a})`),void 0!==r&&p(`calc(${r} * ${a})`)},[t,r,a,i,e]);return(0,n.N)(f,[f]),(0,l.useEffect)(f,[]),{height:o,minHeight:d,maxHeight:c,boxSizing:"content-box"}}},55412:(e,t,r)=>{r.d(t,{O:()=>l});var n=r(96540);let l=({htmlContainerRef:e,htmlContainer:t,onLinkClick:r,openLinksInNewTab:l})=>{(0,n.useEffect)(()=>{let n=e?.current||t;if(!n)return;let i=e=>{let t=e.target.closest("a");t&&(r?.(e),!e.defaultPrevented&&l&&t.href&&(window.open(t.href,"_blank","noopener noreferrer"),e.preventDefault()))};return n.addEventListener("click",i),()=>{n?.removeEventListener("click",i)}},[t,e,r,l])}},84100:(e,t,r)=>{r.d(t,{U:()=>a,g:()=>i});var n=r(38568),l=r(96540);let i=Symbol("callbackCancelledResult"),a=(e,t=!1)=>{let r=(0,l.useRef)(e);(0,n.N)(()=>{r.current=e},[e]);let a=(0,l.useRef)(!1);return(0,l.useEffect)(()=>(a.current=!0,()=>{t||(a.current=!1)}),[t]),(0,l.useCallback)((...e)=>a.current?r.current(...e):i,[])}},80758:(e,t,r)=>{r.d(t,{H:()=>a});var n=r(96540);let l=(e,t,r)=>{let n=t[1]-t[0];return e<t[0]?e:e<t[1]?t[0]+r:e+(r-n)},i=(e,t)=>({...e,nativeEvent:e,target:t,currentTarget:t,preventDefault:()=>e.preventDefault(),isDefaultPrevented:()=>e.defaultPrevented,isPropagationStopped:()=>!1,persist:()=>({})}),a=({inputRef:e,fallbackEventHandler:t})=>(0,n.useCallback)((r,n,a)=>{let o=e.current;if(!o)return;let s=document.activeElement;o.focus();let d=n??[o.selectionStart??o.value.length,o.selectionEnd??o.value.length],u=void 0===a?l(o.selectionStart??o.value.length,d,r.length):Array.isArray(a)?a[0]:a,c=Array.isArray(a)?a[1]:u,p=!1;try{if(document.activeElement!==o)throw Error("Input must be focused to use execCommand");o.setSelectionRange(d[0],d[1]),p=""===r?document.execCommand("delete",!1):document.execCommand("insertText",!1,r),o.setSelectionRange(u,c)}catch{p=!1}if((s instanceof HTMLInputElement||s instanceof HTMLTextAreaElement)&&s.focus(),!p){let n=o.value.slice(0,d[0])+r+o.value.slice(d[1]),l=new InputEvent("input",{bubbles:!1});e.current.value=n,e.current.setSelectionRange(u,c),e.current.dispatchEvent(l),t(i(l,e.current))}},[e,t])},26514:(e,t,r)=>{r.d(t,{T:()=>f});var n=r(74848),l=r(45996),i=r(38621),a=r(87330),o=r(96540),s=r(20053),d=r(14616),u=r(13080),c=r(76797);let p={tooltip:"CopyToClipboardButton-module__tooltip--Dq1IB"};function f({icon:e=i.CopyIcon,size:t="medium",onCopy:r,textToCopy:f,tooltipProps:m,variant:h="invisible",ariaLabel:g,className:v,disabled:b,...x}){let[w,y]=o.useState(!1),k=(0,l.A)(),C=g??`Copy "${f}" to clipboard`,j=w?"Copied!":C,S={size:t,variant:h,onClick:()=>{y(!0),(0,u.i)("Copied!"),(0,c.D)(f),r?.(),setTimeout(()=>k()&&y(!1),2e3)},icon:w?i.CheckIcon:e,className:(0,s.$)(w?"color-fg-success":void 0,v),...x},_=(0,o.useId)();return b?(0,n.jsx)(a.K,{...S,"aria-label":C,disabled:!0}):(0,n.jsx)(d.m,{text:j,"aria-label":C,type:"label",id:_,"aria-hidden":!0,...m,className:(0,s.$)(p.tooltip,m?.className),children:(0,n.jsx)(a.K,{...S,"aria-labelledby":_})})}try{f.displayName||(f.displayName="CopyToClipboardButton")}catch{}},70255:(e,t,r)=>{r.d(t,{a:()=>D});var n=r(74848),l=r(70170);let i=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"],a=(e,t)=>{let{height:r,top:n,left:l}=function(e,t){let r="mozInnerScreenX"in window,n=document.createElement("div");n.id="input-textarea-caret-position-mirror-div",document.body.appendChild(n);let l=n.style,a=window.getComputedStyle(e),o=isNaN(parseInt(a.lineHeight))?1.2*parseInt(a.fontSize):parseInt(a.lineHeight),s=e instanceof HTMLInputElement;for(let t of(l.whiteSpace=s?"nowrap":"pre-wrap",l.wordWrap=s?"":"break-word",l.position="absolute",i))if(s&&"lineHeight"===t){if("border-box"===a.boxSizing){let e=parseInt(a.height),t=parseInt(a.paddingTop)+parseInt(a.paddingBottom)+parseInt(a.borderTopWidth)+parseInt(a.borderBottomWidth),r=t+o;e>r?l.lineHeight=`${e-t}px`:e===r?l.lineHeight=a.lineHeight:l.lineHeight="0"}else l.lineHeight=a.height}else if(s||"width"!==t||"border-box"!==a.boxSizing)l[t]=a[t];else{let t=parseFloat(a.borderLeftWidth)+parseFloat(a.borderRightWidth),n=r?parseFloat(a.width)-t:e.clientWidth+t;l.width=`${n}px`}r?e.scrollHeight>parseInt(a.height)&&(l.overflowY="scroll"):l.overflow="hidden",n.textContent=e.value.substring(0,t),s&&(n.textContent=n.textContent.replace(/\s/g,"\xa0"));let d=document.createElement("span");d.textContent=s?".":e.value.substring(t)||".",n.appendChild(d);let u={top:d.offsetTop+parseInt(a.borderTopWidth),left:d.offsetLeft+parseInt(a.borderLeftWidth),height:o};return document.body.removeChild(n),u}(e,t);return{height:r,top:n-e.scrollTop,left:l-e.scrollLeft}},o=(e,t)=>{let{top:r,left:n,height:l}=a(e,t),{top:i,left:o}=e.getBoundingClientRect();return{height:l,top:i+r,left:o+n}};var s=r(47584),d=r(80758),u=r(74021),c=r(64515),p=r(16255),f=r(20053),m=r(96540),h=r(35908),g=r(38568);let v=({isOpen:e,listElement:t,inputElement:r,onCommit:n,options:l,tabInsertsSuggestions:i=!1,firstOptionSelectionMode:a="none"})=>{let o=(0,m.useId)(),s=`combobox-${o}__option`,d=(0,m.useRef)(e),[u,c]=(0,m.useState)(null),p=(0,m.useCallback)(()=>[...t?.querySelectorAll("[role=option]")??[]],[t]),f=(0,m.useCallback)(e=>{let t=e.target.getAttribute("data-combobox-list-index"),r=l[null!==t?parseInt(t,10):NaN];r&&n({nativeEvent:e,option:r})},[l,n]),v=(0,m.useCallback)(e=>e.preventDefault(),[]);(0,m.useEffect)(function(){if(r&&t){t.getAttribute("role")||t.setAttribute("role","listbox");let e=new h.A(r,t,{tabInsertsSuggestions:i,firstOptionSelectionMode:a});return c(e),()=>{e.destroy(),c(null)}}},[r,t,i,a]),(0,m.useEffect)(function(){let t=d.current;d.current=e&&null!==u,e!==t&&u&&(e?u.start():u.stop())},[e,u]),(0,m.useEffect)(function(){return t?.addEventListener("combobox-commit",f),()=>t?.removeEventListener("combobox-commit",f)},[f,t]),(0,g.N)(()=>{let e=p();for(let[t,r]of e.entries())(!r.id||r.id.startsWith(s))&&(r.id=`${s}-${t}`),r.setAttribute("data-combobox-list-index",t.toString()),r.addEventListener("mousedown",v);return u?.resetSelection(),()=>{for(let t of e)t.removeEventListener("mousedown",v)}},[p,s,l,u,v])};var b=r(63867),x=r(8338),w=r(45221),y=r(47413);let k={Box_0:"AutocompleteSuggestions-module__Box_0--iBnIs",Overlay_0:"AutocompleteSuggestions-module__Overlay_0--QuLJW",ActionListItem:"AutocompleteSuggestions-module__ActionListItem--jPkc1"},C=new Set([" ","\n"]),j=new Set([".","\n"]),S=(e,t,r)=>{let n=e.sort((e,t)=>t.triggerChar.length-e.triggerChar.length);for(let e=r-1,l="",i=n;e>=0&&i.length>0;e--){let r=t[e]??"";for(let n of(l=r+l,C.has(r)&&(i=i.filter(e=>e.multiWord)),j.has(r)&&(i=i.filter(e=>!e.multiWord)),i.filter(e=>l.startsWith(e.triggerChar)))){let r=t[e-1]??"",a=l[1]??"";if((!r||/[\s([]/.test(r))&&(!a||!/\s/.test(a)))return{trigger:n,query:l.slice(n.triggerChar.length)};i=i.filter(e=>e!==n)}}return null},_=e=>"string"==typeof e?e:e.value,E=e=>"string"==typeof e?e:e.key??e.value,N=(...e)=>t=>{for(let r of[...e].reverse())t.isDefaultPrevented()||r?.(t)},L=()=>(0,n.jsx)("div",{className:k.Box_0,children:(0,n.jsx)(b.A,{size:"small"})}),I=({suggestion:e})=>{let t=_(e),r={id:t,children:t,role:"option",className:k.ActionListItem};return"string"==typeof e?(0,n.jsx)(x.l.Item,{...r}):e.render(r)},T=({suggestions:e,portalName:t,triggerCharCoords:r,onClose:l,onCommit:i,inputRef:a,visible:o,tabInsertsSuggestions:s,defaultPlacement:d,firstOptionSelectionMode:u="active"})=>{let c=(0,m.useRef)(null),[p,f]=(0,m.useState)(null),h=(0,m.useCallback)(({option:e})=>{i(_(e))},[i]);v({isOpen:o&&"loading"!==e,listElement:p,inputElement:a.current,onCommit:h,options:Array.isArray(e)?e:[],tabInsertsSuggestions:s,firstOptionSelectionMode:u});let[g,b]=(0,m.useState)(0);return(0,w.A)(function(){let e=c.current?.offsetHeight??0,t=r.top+r.height,n=t+e>window.innerHeight,l=r.top-e,i=l<0,a={below:n&&!i?l:t,above:i&&!n?t:l}[d];b(Number.isNaN(a)?0:a)},[r.top,r.height,e,o,d]),o?(0,n.jsx)(y.Ay,{onEscape:l,onClickOutside:l,returnFocusRef:a,preventFocusOnOpen:!0,portalContainerName:t,top:g,left:r.left,ref:c,className:k.Overlay_0,children:(0,n.jsx)(x.l,{ref:f,role:"listbox",children:"loading"===e?(0,n.jsx)(L,{}):e?.map(e=>n.jsx(I,{suggestion:e},E(e)))})}):(0,n.jsx)(n.Fragment,{})};T.displayName="SuggestionList";try{L.displayName||(L.displayName="LoadingIndicator")}catch{}try{I.displayName||(I.displayName="SuggestionListItem")}catch{}let M={container:"InlineAutocomplete-module__container--UwGMb",fullWidth:"InlineAutocomplete-module__fullWidth--X6eXo"},$=e=>{try{return e.selectionStart}catch(e){if(e instanceof TypeError)return null;throw e}},A=()=>{},D=({triggers:e,suggestions:t,onShowSuggestions:r,onHideSuggestions:i,onSelectSuggestion:a,style:h,children:g,tabInsertsSuggestions:v=!1,suggestionsPlacement:b="below",firstOptionSelectionMode:x="active",portalName:w,fullWidth:y=!1,...k})=>{let[,C]=(0,m.useState)(0),j=(0,u.Lf)(k),E=(0,m.useRef)(null);(0,c.T)(g.ref??A,E);let L=function(e,t){if(m.Children.only(e),t.current&&!(t.current instanceof HTMLInputElement)&&!(t.current instanceof HTMLTextAreaElement))throw TypeError("AutocompleteTextarea child must be a component that forwards a ref and props to an <input> or <textarea> element.");return e}(g,E),I=(0,d.H)({inputRef:E,fallbackEventHandler:L.props.onChange??A}),D=(0,m.useRef)(null),R=null!==t&&t.length>0;(0,m.useEffect)(()=>{if(R){let e=(0,l.n)(()=>C(e=>e+1),100);return document.addEventListener("scroll",e,{capture:!0}),()=>{document.removeEventListener("scroll",e,{capture:!0})}}},[R]);let H=E.current&&D.current&&R?o(E.current,($(E.current)??0)-D.current.query.length):{top:0,left:0,height:0},P=(0,m.cloneElement)(L,{...j,onBlur:N(L.props.onBlur,()=>{i()}),onKeyDown:N(L.props.onKeyDown,e=>{R&&("Escape"===e.key||"Tab"===e.key&&!v)&&(i(),e.stopPropagation())}),onChange:N(L.props.onChange,t=>{let n=$(t.currentTarget);if(null===n){i();return}D.current=S(e,t.currentTarget.value,n),D.current?r(D.current):i()}),ref:E}),B=R?"loading"===t?"Loading autocomplete suggestions\u2026":`${t.length} autocomplete ${1===t.length?"suggestion":"suggestions"} available; "${_(t[0])}" is highlighted. Press ${v?"Enter or Tab":"Enter"} to insert.`:"";return(0,n.jsxs)("div",{className:(0,f.$)(M.container,y&&M.fullWidth),style:h,children:[P,s.KJ&&(0,n.jsx)(T,{suggestions:t,inputRef:E,onCommit:e=>{if(!E.current||!D.current)return;let{query:t,trigger:r}=D.current;a?.({suggestion:e,trigger:r,query:t});let n=$(E.current)??0,l=t.length+r.triggerChar.length,o=n-l,s=r.keepTriggerCharOnCommit??!0?r.triggerChar:"",d=r.insertSpaceOnCommit??!0,u=`${s}${e}${d?" ":""}`;i(),I(u,[o,o+l])},onClose:i,triggerCharCoords:H,visible:R,tabInsertsSuggestions:v,defaultPlacement:b,firstOptionSelectionMode:x,portalName:w}),s.KJ&&(0,n.jsx)(p.Z,{children:(0,n.jsx)("span",{"aria-live":"assertive","aria-atomic":!0,style:{clipPath:"circle(0)",position:"absolute"},children:B})})]})};try{D.displayName||(D.displayName="InlineAutocomplete")}catch{}},83876:(e,t,r)=>{r.d(t,{x:()=>v});var n=r(74848),l=r(8338),i=r(96540),a=r(92575),o=r(5804),s=r(90204);function d(e){return"character"in e}let u=new Set(["+1","thumbsup","-1"]),c={triggerChar:":",keepTriggerCharOnCommit:!1},p=(e,t)=>void 0!==t?(0,n.jsx)("g-emoji",{alias:e.name,tone:t,"fallback-src":e.url,children:e.character}):e.character,f=(e,t)=>d(e)?void 0!==t?(0,s.R3)(e.character,t):e.character:`:${e.name}:`,m=e=>t=>({value:f(t,e),key:t.name,render:r=>(0,n.jsxs)(l.l.Item,{...r,children:[(0,n.jsx)(l.l.LeadingVisual,{children:d(t)?p(t,e):(0,n.jsx)("img",{src:t.url,alt:`${t.name} emoji`,height:"16",width:"16"})}),t.name]})}),h=(e,t)=>{let r=t.name.toLowerCase(),n=e.toLowerCase(),l=0;return r.includes(n)&&(l+=5,r.startsWith(n)&&(l+=5)),0===l?o.IP:l},g=(e,t)=>{let r=e.name.toLowerCase(),n=t.name.toLowerCase();return u.has(r)&&!u.has(n)?-1:u.has(n)&&!u.has(r)?1:0},v=(e,t)=>({calculateSuggestions:(0,i.useMemo)(()=>(0,a.C)(e,h,g,m(t?.tone),!0),[e,t?.tone]),trigger:c});try{u.displayName||(u.displayName="PRIORITIZED_EMOJIS")}catch{}},83476:(e,t,r)=>{r.d(t,{G:()=>b});var n=r(74848),l=r(96540),i=r(64515),a=r(75177),o=r(63867),s=r(44968),d=r(55412),u=r(27278),c=r(45221);let p=e=>{let t=e.match(/^ {0,3}(`{3,}|~{3,})[^`]*$/);return t?t[1]:null},f=(e,t)=>RegExp(`^ {0,3}${t}${t[0]}* *$`).test(e),m=e=>"string"==typeof e?.taskBox,h=e=>({...e,taskBox:"[ ]"===e.taskBox?"[x]":"[ ]"}),g=({htmlContainer:e,markdownValue:t,onChange:r,disabled:n=!1,dependencies:i=[]})=>{let a=(0,l.useRef)(t);(0,c.A)(()=>{a.current=t},[t]);let o=(0,l.useCallback)(e=>()=>{let t=a.current.split(/\r?\n/),n=null;for(let l=0,i=0;l<t.length;l++){let o=t[l];if(n){if(f(o,n)){n=null;continue}}else n=p(o);if(n)continue;let s=(0,u.VB)(o);if(m(s)){if(i===e){let e=(0,u.a1)(h(s));t.splice(l,1,e);let n=t.join("\n");a.current=n,r(n);return}i++}}},[r]),[s,d]=(0,l.useState)([]);(0,l.useEffect)(()=>{d(Array.from(e?.querySelectorAll("input[type=checkbox].task-list-item-checkbox")??[]))},[e,...i]),(0,l.useEffect)(function(){let e=s.map(e=>{let t=e.disabled;return e.disabled=n,()=>{e.disabled=t}});return()=>{for(let t of e)t()}},[s,n]),(0,l.useEffect)(function(){let e=s.map((e,t)=>{let r=o(t);return e.addEventListener("change",r),()=>{e.removeEventListener("change",r)}});return()=>{for(let t of e)t()}},[s,o])};var v=r(20053);let b=(0,l.forwardRef)(function({verifiedHTML:e,loading:t=!1,markdownValue:r="",onChange:u,disabled:c=!1,onLinkClick:p,openLinksInNewTab:f=!1,teamHovercardsEnabled:m=!1,className:h},b){let[x,w]=(0,l.useState)(null),y=(0,l.useRef)(null);(0,i.T)(b,y);let k=(0,l.useCallback)(e=>{y.current=e,w(e)},[]);return g({onChange:(0,l.useCallback)(async t=>{try{await u?.(t)}catch{x&&(x.innerHTML=e)}},[u,x,e]),disabled:c||!u,htmlContainer:x??void 0,markdownValue:r,dependencies:[e]}),(0,d.O)({htmlContainer:x??void 0,onLinkClick:p,openLinksInNewTab:f}),(0,l.useMemo)(()=>t?(0,n.jsx)(a.A,{sx:{display:"flex",justifyContent:"space-around",p:2},children:(0,n.jsx)(o.A,{"aria-label":"Loading content..."})}):(0,n.jsx)(s.oG,{ref:k,className:(0,v.$)("markdown-body",h),sx:h?{}:{fontSize:1,maxWidth:"100%","& > div > :last-child":{mb:0}},html:e,...m?{"data-team-hovercards-enabled":!0}:{}}),[h,t,m,e,k])});try{b.displayName||(b.displayName="MarkdownViewer")}catch{}}}]);
//# sourceMappingURL=ui_packages_comment-box_api_file-upload_ts-ui_packages_comment-box_api_preview_ts-ui_packages-630ec3-aedd87e69347.js.map